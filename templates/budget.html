<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>År 2024, Inkomst/Utgifter</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='style_budget.css') }}">
</head>
<body>
    <h1>År 2024, Inkomst/Utgifter</h1>

    <!-- Formulär för att lägga till nya poster -->
    <form method="POST">
        <label for="date">Datum:</label>
        <input type="date" id="date" name="date" required><br>        

        <label for="label">Kategori:</label>
        <select id="label" name="label" required>
            <option value="income">Inkomst</option>
            <option value="mortgage">Huslån</option>
            <option value="electricity">Elräkning</option>
            <option value="insurance">Försäkring</option>
            <option value="waterbill">Vattenräkning</option>
            <option value="food">Mat</option>
            <option value="transport">Transport</option>
        </select><br>

        <label for="person">Person:</label>
        <select id="person" name="person" required>
            <option value="Alexander">Alexander</option>
            <option value="Hanna">Hanna</option>
        </select><br>

        <label for="description">Beskrivning:</label>
        <input type="text" id="description" name="description" required><br>

        <label for="amount">Belopp:</label>
        <input type="number" id="amount" name="amount" required><br>

        <button type="submit">Spara</button>
    </form>

    <!-- Sektion för sammanfattning -->
    <div>
        <h2>Sammanfattning</h2>
        <p>Totala inkomster: {{ budget_data.totals.income }} SEK</p>
        <p>Totala utgifter: {{ budget_data.totals.expenses }} SEK</p>
    </div>

    <!-- Sektion för kategorier -->
    <div>
        <h2>Kategorier</h2>
        <ul>
            {% for category, amount in budget_data.categories.items() %}
                <li>{{ category | capitalize }}: {{ amount }} SEK</li>
            {% endfor %}
        </ul>
    </div>

    <!-- Pie Chart -->
    <div>
        <h2>Diagram över budget</h2>
        <canvas id="budgetChart"></canvas>
    </div>

    <!-- JavaScript för Chart.js -->
    <script>
        // Data för pie chart från servern
        const budgetData = {
            labels: Object.keys({{ budget_data.categories | tojson }}),
            values: Object.values({{ budget_data.categories | tojson }})
        };

        // Skapa pie chart
        const ctx = document.getElementById('budgetChart').getContext('2d');
        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: budgetData.labels,
                datasets: [{
                    data: budgetData.values,
                    backgroundColor: [
                        '#ff6384', // Inkomst
                        '#00FF00', // Huslån
                        '#ffcd56', // Försäkring
                        '#4bc0c0', // Vattenräkning
                        '#9966ff', // Mat
                        '#ff9f40'  // Transport
                    ],
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.label + ': ' + context.raw + ' SEK';
                            }
                        }
                    }
                }
            }
        });
    </script>
</body>
</html>
